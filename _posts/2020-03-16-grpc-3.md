---
layout: post
published: true
title: gRPC #3
subtitle: Implementing simple chat example
date: '2020-03-16'
---

# Chat Program with gRPC

먼저 IDE는 PyCharm을 택했다. Visual Code가 좀 더 기능도 좋고 그럴진 모르겠으나, 그냥 익숙한 것 쓰기로..

프로젝트 생성시 Interpreter를 이전에 만든 gRPC conda environment를 그대로 쓰기로 한다. PyCharm 설치는

[이 곳](https://enant.tistory.com/10)을 참조하면 된다. 구글에 그냥 검색하면 Instruction은 수두룩하게 있으니 금방 설치할 수 있다.



[튜토리얼](https://grpc.io/docs/tutorials/basic/python/)을 옆에 띄워두고 이를 보면서 하나씩 익히면서 짜볼 것이다. 포스팅하진 않겠지만 궁금하다면 [이 곳](https://developers.google.com/protocol-buffers/docs/proto3)을 공부하면 도움이 될 듯 하다. 



### Making Project

간단한 프로그램이지만 세 개의 프로젝트를 생성할 것이다.

* chat-proto
* chat-server
* chat-client

예제이므로 하나에 그냥 다 묶어버리면 그만이지만 결국엔 나중에 저런식으로 다 나누게 된다. 간단히 생각해봐도, 채팅 프로그램을 배포하려하는데 서버까지 배포하면 이상하지 않은가 ? 그리고 proto가 바뀌면 계속 컴파일 할텐데 아마 이렇게 따로 관리하면 좀 더 편하지 않을까 싶다.

##### making chat-proto, chat-server, chat-client 

1. File -> New Project 이후 아래와 같이 진행한다. 경로는 각자 다 다를 수 있으니 각자의 경로를 잘 찾아 입력하면 되고 위에서 말했듯 저번에 만들어둔 gRPC 환경을 그대로 쓸 것이다.

   ![create-project]()

   ![add-interpreter]()

2. 위 와 같은 방법으로 chat-server와 chat-client를 생성하는데, Attach로 프로젝트를 열면 한 Explorer안에 리스트로 쭉 붙으니 그게 편한 사람은 Attach로 새 창에다 프로젝트 띄우고 싶으면 New window로 하면된다. This Window는 먼저 열어둔 프로젝트가 닫힌다.



### chat-proto

채팅 메세지를 어떻게 정의할 수 있을까 ? 일단 복잡하게 생각하지 말고 그냥 단편적인 메세지로 생각하고 진행해보자.

![protoc]()

이제 chat-proto 패키지에 `chat_message_pb2.py` `chat_message_pb2_grpc.py`가 생겼을 것이고, 이 것을 쓰려면 conda환경에 chat-proto를 설치해줘야 한다.

![chat-proto-install]()

그럼 이제 chat-server나 chat-client 프로젝트가 같은 conda 환경을 쓰고 있으니, 저 chat-proto를 갖다 쓸 수 있다.



### chat-server

